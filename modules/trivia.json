{
  "commands": [
    {
      "function": "import { takaro, data, TakaroUserError, checkPermission } from '@takaro/helpers';\n\nasync function main() {\n    const { gameServerId, module: mod, player, chatMessage, pog } = data;\n\n    if (!checkPermission(pog, 'TRIVIA_PARTICIPATE')) {\n        throw new TakaroUserError('You do not have permission to participate in trivia!');\n    }\n\n    const answer = chatMessage.msg.split(' ').slice(1).join(' ');\n\n    // Get all trivia variables\n    const triviaVars = await takaro.variable.variableControllerSearch({\n        filters: {\n            key: ['trivia_question', 'trivia_answer', 'trivia_reward'],\n            gameServerId: [gameServerId],\n            moduleId: [mod.moduleId]\n        }\n    });\n\n    if (triviaVars.data.data.length === 0) {\n        throw new TakaroUserError('There is no active trivia question right now!');\n    }\n\n    // Parse variables\n    const vars = triviaVars.data.data.reduce((acc, curr) => {\n        acc[curr.key] = curr;\n        return acc;\n    }, {});\n\n    const question = vars.trivia_question.value;\n    const correctAnswer = vars.trivia_answer.value;\n    const reward = JSON.parse(vars.trivia_reward.value);\n\n    if (answer.toLowerCase() === correctAnswer.toLowerCase()) {\n        if (reward.type === 'currency') {\n            await takaro.playerOnGameserver.playerOnGameServerControllerAddCurrency(gameServerId, player.id, {\n                currency: reward.amount\n            });\n\n            const currencyName = (await takaro.settings.settingsControllerGetOne('currencyName', gameServerId)).data.data.value;\n            await takaro.gameserver.gameServerControllerSendMessage(gameServerId, {\n                message: `${player.name} answered \"${question}\" correctly and received ${reward.amount} ${currencyName}!`\n            });\n        } else {\n            // For items, we need to get the item details first\n            const itemDetails = (await takaro.item.itemControllerFindOne(reward.itemId)).data.data;\n\n            await takaro.gameserver.gameServerControllerGiveItem(gameServerId, player.id, {\n                name: itemDetails.code,\n                amount: reward.amount,\n                quality: reward.quality || ''\n            });\n\n            await takaro.gameserver.gameServerControllerSendMessage(gameServerId, {\n                message: `${player.name} answered \"${question}\" correctly and received ${reward.amount}x ${itemDetails.name}!`\n            });\n        }\n\n        // Clean up all trivia variables\n        await Promise.all(Object.values(vars).map(variable =>\n            takaro.variable.variableControllerDelete(variable.id)\n        ));\n    } else {\n        await takaro.gameserver.gameServerControllerSendMessage(gameServerId, {\n            message: `${player.name} guessed \"${answer}\" - That's not correct! Try again!`\n        });\n    }\n}\n\nawait main();",
      "name": "playerAnswer",
      "trigger": "answer",
      "helpText": "No help text available",
      "arguments": []
    }
  ],
  "hooks": [],
  "cronJobs": [
    {
      "function": "import { takaro, data } from '@takaro/helpers';\n\nasync function main() {\n    const { gameServerId, module: mod } = data;\n\n    // Check for online players\n    const currentPlayers = (await takaro.playerOnGameserver.playerOnGameServerControllerSearch({\n        filters: {\n            gameServerId: [gameServerId],\n            online: [true]\n        }\n    })).data.meta;\n\n    if (currentPlayers.total === 0) {\n        return;\n    }\n\n    // Get questions from config or use default\n    const questions = mod.userConfig.questions || [\n        { question: \"What is the largest country in the world?\", answer: \"Russia\" }\n    ];\n\n    // Clear any existing questions/rewards\n    const existingVariables = await takaro.variable.variableControllerSearch({\n        filters: {\n            key: ['trivia_question', 'trivia_answer', 'trivia_reward'],\n            gameServerId: [gameServerId],\n            moduleId: [mod.moduleId]\n        }\n    });\n\n    // Delete all existing trivia variables\n    await Promise.all(existingVariables.data.data.map(variable =>\n        takaro.variable.variableControllerDelete(variable.id)\n    ));\n\n    // Select random question\n    const randomQuestion = questions[Math.floor(Math.random() * questions.length)];\n\n    // Store question separately\n    await takaro.variable.variableControllerCreate({\n        key: 'trivia_question',\n        value: randomQuestion.question,\n        gameServerId,\n        moduleId: mod.moduleId\n    });\n\n    // Store answer separately\n    await takaro.variable.variableControllerCreate({\n        key: 'trivia_answer',\n        value: randomQuestion.answer,\n        gameServerId,\n        moduleId: mod.moduleId\n    });\n\n    // Setup reward\n    const rewardType = mod.userConfig.rewardType || 'currency';\n    if (rewardType === 'items') {\n        const configuredItems = mod.userConfig.rewardItems || [];\n        if (configuredItems.length > 0) {\n            const randomItemIndex = Math.floor(Math.random() * configuredItems.length);\n            const selectedItem = configuredItems[randomItemIndex];\n\n            // Store reward info separately\n            await takaro.variable.variableControllerCreate({\n                key: 'trivia_reward',\n                value: JSON.stringify({\n                    type: 'items',\n                    itemId: selectedItem.item,\n                    amount: selectedItem.amount || 1,\n                    quality: selectedItem.quality || ''\n                }),\n                gameServerId,\n                moduleId: mod.moduleId\n            });\n        } else {\n            console.error('Items reward type selected but no items configured');\n            return;\n        }\n    } else {\n        // Store currency reward info\n        await takaro.variable.variableControllerCreate({\n            key: 'trivia_reward',\n            value: JSON.stringify({\n                type: 'currency',\n                amount: mod.userConfig.rewardAmount || 100\n            }),\n            gameServerId,\n            moduleId: mod.moduleId\n        });\n    }\n\n    const prefix = (await takaro.settings.settingsControllerGetOne('commandPrefix', gameServerId)).data.data.value;\n\n    await takaro.gameserver.gameServerControllerSendMessage(gameServerId, {\n        message: `Trivia Time! ${randomQuestion.question} (Answer with ${prefix}answer <your guess>)`\n    });\n}\n\nawait main();",
      "name": "TriviaTime",
      "temporalValue": "5 * * * *"
    }
  ],
  "functions": [],
  "permissions": [
    {
      "canHaveCount": false,
      "description": "TRIVIA_PARTICIPATE",
      "permission": "TRIVIA_PARTICIPATE",
      "friendlyName": "TRIVIA_PARTICIPATE"
    }
  ],
  "name": "Trivia Time",
  "description": "This module lets you create custom trivia questions and set up different types of rewards.",
  "configSchema": "{\"$schema\": \"http://json-schema.org/draft-07/schema#\", \"type\": \"object\", \"properties\": {\"rewardItems\": {\"title\": \"Items\", \"description\": \"If you choose items as a rewardtype, you will be able to select a list of items.\", \"x-component\": \"item\", \"type\": \"array\", \"uniqueItems\": true, \"items\": {\"type\": \"object\", \"title\": \"Item\", \"properties\": {\"item\": {\"type\": \"string\", \"title\": \"Item\"}, \"amount\": {\"type\": \"number\", \"title\": \"Amount\"}, \"quality\": {\"type\": \"string\", \"title\": \"Quality\"}}}}, \"rewardType\": {\"title\": \"rewardType\", \"description\": \"Choose Currency or items\", \"default\": \"currency\", \"type\": \"string\", \"enum\": [\"currency\", \"items\"]}, \"rewardAmount\": {\"title\": \"rewardAmount\", \"description\": \"If you choose currency this will be the reward amount\", \"default\": 0, \"type\": \"number\", \"minimum\": 1, \"maximum\": 100000}, \"questions\": {\"type\": \"array\", \"title\": \"Questions\", \"description\": \"Key value pairs of questions and answers\", \"items\": {\"type\": \"object\", \"properties\": {\"question\": {\"type\": \"string\", \"description\": \"The question\", \"minLength\": 1}, \"answer\": {\"type\": \"string\", \"description\": \"The answer\"}}}, \"default\": [{\"question\": \"What is the capital of France?\", \"answer\": \"Paris\"}, {\"question\": \"What is a baby goat called?\", \"answer\": \"Kid\"}, {\"question\": \"What is the largest mammal?\", \"answer\": \"Blue Whale\"}, {\"question\": \"What is the largest planet in our solar system?\", \"answer\": \"Jupiter\"}, {\"question\": \"What is the largest ocean on Earth?\", \"answer\": \"Pacific Ocean\"}, {\"question\": \"What is the largest country in the world?\", \"answer\": \"Russia\"}, {\"question\": \"What is the largest desert in the world?\", \"answer\": \"Antarctica\"}, {\"question\": \"What is the largest continent on Earth?\", \"answer\": \"Asia\"}, {\"question\": \"What is the largest mountain in the world?\", \"answer\": \"Mount Everest\"}, {\"question\": \"What is the largest forest in the world?\", \"answer\": \"Amazon Rainforest\"}, {\"question\": \"What is the name of the main character in The Legend of Zelda series?\", \"answer\": \"Link\"}, {\"question\": \"Which video game features a battle royale mode called Warzone?\", \"answer\": \"Call of Duty\"}, {\"question\": \"In Minecraft, what do you need to make a Nether portal?\", \"answer\": \"Obsidian and Flint & Steel\"}, {\"question\": \"What is the best-selling video game of all time?\", \"answer\": \"Minecraft\"}, {\"question\": \"What color is Sonic the Hedgehog?\", \"answer\": \"Blue\"}, {\"question\": \"Which company created the PlayStation?\", \"answer\": \"Sony\"}, {\"question\": \"In Super Mario Bros., what power-up makes Mario grow bigger?\", \"answer\": \"Super Mushroom\"}, {\"question\": \"Which video game series features assassins reliving memories through the Animus?\", \"answer\": \"Assassin\\u2019s Creed\"}, {\"question\": \"Who is the main protagonist in Demon Slayer?\", \"answer\": \"Tanjiro Kamado\"}, {\"question\": \"What is the highest rank of a Demon Slayer?\", \"answer\": \"Hashira\"}, {\"question\": \"Which anime features a cursed finger as a key plot point?\", \"answer\": \"Jujutsu Kaisen\"}, {\"question\": \"Which anime character says 'Believe it!'?\", \"answer\": \"Naruto Uzumaki\"}, {\"question\": \"In One Piece, what fruit did Luffy eat?\", \"answer\": \"Gomu Gomu no Mi\"}, {\"question\": \"What anime is about a hero who defeats enemies with one punch?\", \"answer\": \"One Punch Man\"}, {\"question\": \"Who is the captain of Squad 10 in Bleach?\", \"answer\": \"T\\u014dshir\\u014d Hitsugaya\"}, {\"question\": \"Which anime has a tournament called the 'Ch\\u016bnin Exams'?\", \"answer\": \"Naruto\"}, {\"question\": \"What is the name of the fictional African country in Black Panther?\", \"answer\": \"Wakanda\"}, {\"question\": \"Which movie franchise features Autobots and Decepticons?\", \"answer\": \"Transformers\"}, {\"question\": \"Who played Jack Sparrow in Pirates of the Caribbean?\", \"answer\": \"Johnny Depp\"}, {\"question\": \"What is the name of the AI in 2001: A Space Odyssey?\", \"answer\": \"HAL 9000\"}, {\"question\": \"Which movie features a shark terrorizing a beach town?\", \"answer\": \"Jaws\"}, {\"question\": \"Who is the voice of Woody in Toy Story?\", \"answer\": \"Tom Hanks\"}, {\"question\": \"Which film features a DeLorean time machine?\", \"answer\": \"Back to the Future\"}, {\"question\": \"What color is Shrek?\", \"answer\": \"Green\"}, {\"question\": \"Which superhero movie introduced the multiverse concept in 2021?\", \"answer\": \"Spider-Man: No Way Home\"}, {\"question\": \"Who is Luke Skywalker\\u2019s father?\", \"answer\": \"Darth Vader\"}, {\"question\": \"Which movie is about dreams within dreams?\", \"answer\": \"Inception\"}, {\"question\": \"What is the highest-grossing movie of all time?\", \"answer\": \"Avatar\"}, {\"question\": \"Who sang 'Thriller'?\", \"answer\": \"Michael Jackson\"}, {\"question\": \"Which British band sang Wonderwall?\", \"answer\": \"Oasis\"}, {\"question\": \"What is the real name of Lady Gaga?\", \"answer\": \"Stefani Germanotta\"}, {\"question\": \"Which singer is known as the 'Queen of Pop'?\", \"answer\": \"Madonna\"}, {\"question\": \"Which rapper released the song God's Plan?\", \"answer\": \"Drake\"}, {\"question\": \"Who is the lead singer of Queen?\", \"answer\": \"Freddie Mercury\"}, {\"question\": \"Which singer released Rolling in the Deep?\", \"answer\": \"Adele\"}, {\"question\": \"What is the name of BTS\\u2019s fanbase?\", \"answer\": \"ARMY\"}, {\"question\": \"What was The Beatles\\u2019 first album?\", \"answer\": \"Please Please Me\"}, {\"question\": \"Which pop star sang Bad Guy?\", \"answer\": \"Billie Eilish\"}, {\"question\": \"What is the largest land animal?\", \"answer\": \"Elephant\"}, {\"question\": \"What is the only bird that can fly backward?\", \"answer\": \"Hummingbird\"}, {\"question\": \"Which animal has the longest lifespan?\", \"answer\": \"Greenland Shark\"}, {\"question\": \"What is the most venomous snake in the world?\", \"answer\": \"Inland Taipan\"}, {\"question\": \"Which mammal lays eggs?\", \"answer\": \"Platypus\"}, {\"question\": \"What is the only marsupial native to North America?\", \"answer\": \"Opossum\"}, {\"question\": \"Which animal sleeps the most per day?\", \"answer\": \"Koala\"}, {\"question\": \"Which bird is a symbol of peace?\", \"answer\": \"Dove\"}, {\"question\": \"What is the slowest animal in the world?\", \"answer\": \"Sloth\"}, {\"question\": \"What color is a polar bear's skin?\", \"answer\": \"Black\"}]}}, \"additionalProperties\": false}",
  "uiSchema": "{\"rewardItems\":{\"items\":{\"item\":{\"ui:widget\":\"item\"}}}}"
}